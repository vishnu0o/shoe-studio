<%- include ('../layout/homeheader.ejs',{loginsession}) %>
<style>
    .xxx{
        font-weight: 900;
        text-transform: uppercase;
    }
    .xxx:hover{
        color: rgb(118, 167, 167);
    }
    .active1{
        background-color:black;
        color:red;
    }
</style>
    <!-- Page Preloder -->
    <!-- <div id="preloder">
        <div class="loader"></div>
    </div> -->


    <!-- Header Section Begin -->

    <!-- Header Section End -->

    <!-- Hero Section Begin -->
    <section class="hero hero-normal">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="hero__categories">
                        <div class="hero__categories__all">
                            <i class="fa fa-bars"></i>
                            <span>All Categories</span>
                        </div>
                        <ul id="product-row">
                            <% for( let i = 0; i <category.length; i++ ) { %>
                        
                            <li  class=""><button id="<%=category[i]._id%>x" class="xxx "
                                style="background-color: rgb(255, 255, 255); background: transparent;  font-size: larger; margin-bottom: 10px; border: none; " onclick="categoryfilter('<%=category[i]._id%>')"><%=category[i].categoryname%></button></li>
                            <% } %>

                        </ul>
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="hero__search">
                        <div class="hero__search__form">
                            <form>
                                <div class="hero__search__categories">
                                    All Categories
                                    <span class="arrow_carrot-down"></span>
                                </div>
                                <input id="search" onkeyup="xxx()" type="text" name="search" placeholder="What do yo u need?">
                                <!-- <input type="submit" value="search" class="site-btn">SEARCH</input> -->
                            </form>
                        </div>
                        <div class="hero__search__phone">
                            <div class="hero__search__phone__icon">
                                <i class="fa fa-phone"></i>
                            </div>
                            <div class="hero__search__phone__text">
                                <h5>+65 11.188.888</h5>
                                <span>support 24/7 time</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Hero Section End -->


    <!-- Product Section Begin -->
    <section class="product spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-5">
                    <div class="sidebar">
                        <!-- <div class="sidebar__item">
                            <h4>Department</h4>
                            <ul id="product-row">
                                <% for( let i = 0; i <category.length; i++ ) { %>
                            
                                <li  class=""><button id="<%=category[i]._id%>x" class="xxx "
                                    style="background-color: rgb(255, 255, 255); background: transparent;  font-size: larger; margin-bottom: 10px; border: none; " onclick="categoryfilter('<%=category[i]._id%>')"><%=category[i].categoryname%></button></li>
                                <% } %>

                            </ul>
                        </div> -->
                     
                        
                        <div class="sidebar__item">
                            <h4>Sort by Pricerange</h4>
                            <div class="sidebar__item__size">
                                <label for="large">
                                    low to High
                                    <input type="radio" id="large">
                                </label>
                            </div>
                            <div class="sidebar__item__size">
                                <label for="medium">
                                    High to low
                                    <input type="radio" id="medium">
                                </label>
                            </div>
                            
                        </div>
                        <div class="sidebar__item">
                            <div class="latest-product__text">
                                <h4>Latest Products</h4>
                                <div class="latest-product__slider owl-carousel">
                                    <div class="latest-prdouct__slider__item">
                                        <% for( let i=0; i < 3; i++ ) { %>
                                            <% if(productdetails[i].is_deleted==0){ %>


                                                <a href="" class="latest-product__item">
                                                    <div class="latest-product__item__pic">
                                                        <img src="productimages/<%=productdetails[i].images[i]%>"
                                                            alt="">
                                                    </div>
                                                    <div class="latest-product__item__text">
                                                        <h6>
                                                            <%=productdetails[i].product_name %>
                                                        </h6>
                                                        <span>₹<%=productdetails[i].price %></span>
                                                    </div>
                                                </a>
                                                <% }else{} %>
                                                    <% } %>

                                    </div>
                                    <div class="latest-prdouct__slider__item">
                                        <% for( let i=0; i < 3; i++ ) { %>
                                            <% if(productdetails[i].is_deleted==0){ %>

                                                <a href="" class="latest-product__item">
                                                    <div class="latest-product__item__pic">
                                                        <img src="productimages/<%=productdetails[i].images[i]%>"
                                                            alt="">
                                                    </div>
                                                    <div class="latest-product__item__text">
                                                        <h6>
                                                            <%=productdetails[i].product_name %>
                                                        </h6>
                                                        <span>₹<%=productdetails[i].price %></span>
                                                    </div>
                                                </a>
                                                <% }else{} %>
                                                    <% } %>


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-9 col-md-7" >
                  
                    <div class="filter__item">
                        <div class="row">
                            <div class="col-lg-4 col-md-5">
                                <div class="filter__sort">
                                    <span>Sort By</span>
                                    <select>
                                        <option value="0">Default</option>
                                        <option value="0">Default</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-4">
                                <div class="filter__found">
                                    <h6><span>16</span> Products found</h6>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-3">
                                <div class="filter__option">
                                    <span class="icon_grid-2x2"></span>
                                    <span class="icon_ul"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row"  id="filter">
                        <% for( let i=0; i < productdetails.length; i++ ) { %>
                            <% if(productdetails[i].is_deleted==0){ %>


                                <div class="col-lg-4 col-md-6 col-sm-6">
                                    <div class="product__item" >
                                        <div class="product__item__pic set-bg" data-setbg="">
                                            <a href="/productdetails?id=<%=productdetails[i]._id%>"><img id="shopimages" 
                                             src="productimages/<%=productdetails[i].images[1]%>" alt=""></a>
                                            <ul class="product__item__pic__hover">
                                                <li><a onclick="addtowishlist('<%=productdetails[i]._id%>')"><i
                                                            class="fa fa-heart"></i></a></li>

                                                <li><a onclick="addtocart('<%=productdetails[i]._id%>','<%=productdetails[i].quantity_adding%>')"><i
                                                            class="fa fa-shopping-cart"></i></a></li>
                                            </ul>
                                        </div>
                                        <div class="product__item__text">
                                            <h6><a href="#">
                                                    <%=productdetails[i].product_name %>
                                                </a></h6>
                                            <h5>₹<%=productdetails[i].price%>
                                            </h5>
                                        </div>
                                    </div>
                                </div>
                                <% }else{} %>
                                    <% } %>

                    </div>
                    <div class="product__pagination">
                        <a href="#">1</a>
                        <a href="#">2</a>
                        <a href="#">3</a>
                        <a href="#"><i class="fa fa-long-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
       

       
        let ID
        let Search
        function xxx(){
           Search= $('#search').val()
           submit(ID,Search)

        }
        
        function categoryfilter(id) {
            $('.xxx').removeClass('active1')
            $(`#${id}x`).addClass('active1')
            ID=id
            submit(id,Search)
        }
       

           
            function submit(id,search){
          $.ajax({
            type: "GET",
            url: `/categoryfilter?id=${id}&search=${search}`,
            success: function(res) {
                console.log(res);
              let html = "";
              $('#filter').html('');
      
              for (let i = 0; i < res.products.length; i++) {
                if (res.products[i].is_deleted == 0) {
                  html += `
                      <div class="col-lg-4 col-md-6 col-sm-6">
                        <div class="product__item">
                          <div class="product__item__pic set-bg" data-setbg="">
                            <a href="/productdetails?id=${res.products[i]._id}"><img id="shopimages" src="productimages/${res.products[i].images[1]}" alt=""></a>
                            <ul class="product__item__pic__hover">
                              <li><a onclick="addtowishlist('${res.products[i]._id}')"><i class="fa fa-heart"></i></a></li>
                              <li><a onclick="addtocart('${res.products[i]._id}','${res.products[i].quantity_adding}')"><i class="fa fa-shopping-cart"></i></a></li>
                            </ul>
                          </div>
                          <div class="product__item__text">
                            <h6><a href="#">${res.products[i].product_name}</a></h6>
                            <h5>₹${res.products[i].price}</h5>
                          </div>
                        </div>
                      </div>
                  `;
                }
              }
      
              $('#filter').html(html);
              const filtered_btn =  document.getElementById(`${id}`)    
            },
            error: function(err) {
              console.log(err);
            }
          });
        }
 
      </script>
     
     

      
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background-color: lightgrey;">
            <div class="modal-header">
                <h5 class="modal-title text-danger" id="exampleModalLabel">Order Status
                    Update
                </h5>
            </div>
            <div class="modal-body text-danger ">
                Product is Out of Stock
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
        </div>
    </div>

  </div>


    <%- include ('../layout/homefooter.ejs',{loginsession})%>